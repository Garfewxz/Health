<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for better aesthetics and accessibility */
        .form-group label {
            font-weight: 500;
            color: #1f2937; /* A darker gray for better readability */
            display: block;
            margin-bottom: 0.5rem;
        }

        .input-field {
            padding: 10px 12px;
            font-size: 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-field:focus {
            border-color: #3b82f6; /* A clear blue focus color */
            outline: none;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
        }

        .btn-submit {
            transition: background-color 0.2s, transform 0.1s;
        }
        
        .btn-submit:hover {
            background-color: #16a34a; /* A slightly darker green on hover */
        }
        
        .btn-submit:active {
            transform: scale(0.99);
        }

        .modal-container {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

<form id="healthForm" class="bg-white p-8 rounded-lg shadow-xl space-y-6 w-full max-w-lg">
    <h2 class="text-2xl font-bold text-gray-800 text-center">‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</h2>

    <div class="form-group">
        <label for="age">‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ):</label>
        <input type="number" id="age" class="w-full input-field" min="15" max="60" placeholder="15-60">
        <span id="errorAge" class="text-red-500 text-sm mt-1 block"></span>
    </div>

    <div class="form-group">
        <label>‡πÄ‡∏û‡∏®:</label>
        <div class="flex gap-6">
            <label class="inline-flex items-center"><input type="radio" name="gender" value="‡∏ä‡∏≤‡∏¢" class="form-radio text-green-600"> <span class="ml-2">‡∏ä‡∏≤‡∏¢</span></label>
            <label class="inline-flex items-center"><input type="radio" name="gender" value="‡∏´‡∏ç‡∏¥‡∏á" class="form-radio text-green-600"> <span class="ml-2">‡∏´‡∏ç‡∏¥‡∏á</span></label>
        </div>
        <span id="errorGender" class="text-red-500 text-sm mt-1 block"></span>
    </div>

    <div class="form-group">
        <label for="weight">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.):</label>
        <input type="number" id="weight" class="w-full input-field" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 65.5">
        <span id="errorWeight" class="text-red-500 text-sm mt-1 block"></span>
    </div>

    <div class="form-group">
        <label for="height">‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã‡∏°.):</label>
        <input type="number" id="height" class="w-full input-field" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 170">
        <span id="errorHeight" class="text-red-500 text-sm mt-1 block"></span>
    </div>

    <div class="flex items-center">
        <input type="checkbox" id="hasDisease" class="form-checkbox text-green-600 h-5 w-5">
        <label for="hasDisease" class="ml-2 mb-0">‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label>
    </div>

    <div id="diseaseDetailDiv" class="hidden form-group">
        <label for="diseaseDetail">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏£‡∏Ñ:</label>
        <textarea id="diseaseDetail" class="w-full input-field" rows="3" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á"></textarea>
        <span id="errorDiseaseDetail" class="text-red-500 text-sm mt-1 block"></span>
    </div>

    <button type="submit" id="submitButton" class="w-full bg-green-600 text-white p-3 rounded-lg font-semibold btn-submit">‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</button>
</form>

<div id="resultModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center modal-container">
    <div class="bg-white p-8 rounded-lg shadow-xl text-center max-w-sm w-full">
        <h3 class="text-2xl font-bold mb-4 text-green-600">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h3>
        <p id="modalMessage" class="mb-4 text-lg text-gray-700"></p>
        <button id="closeModal" class="bg-green-600 text-white px-6 py-2 rounded-lg font-semibold">‡∏õ‡∏¥‡∏î</button>
    </div>
</div>

<script>
    const hasDiseaseCheckbox = document.getElementById("hasDisease");
    const diseaseDetailDiv = document.getElementById("diseaseDetailDiv");
    const form = document.getElementById("healthForm");
    const submitButton = document.getElementById("submitButton");
    const resultModal = document.getElementById("resultModal");
    const modalMessage = document.getElementById("modalMessage");
    const closeModalButton = document.getElementById("closeModal");

    // Show/hide disease details based on checkbox state
    hasDiseaseCheckbox.addEventListener("change", () => {
        diseaseDetailDiv.classList.toggle("hidden", !hasDiseaseCheckbox.checked);
    });

    form.addEventListener("submit", function(e) {
        e.preventDefault();

        // Disable button to prevent multiple submissions
        submitButton.disabled = true;
        submitButton.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...";

        // Reset errors
        document.querySelectorAll('span[id^="error"]').forEach(el => el.textContent = "");

        let age = parseInt(document.getElementById("age").value);
        let gender = document.querySelector('input[name="gender"]:checked');
        let weight = parseFloat(document.getElementById("weight").value);
        let height = parseFloat(document.getElementById("height").value);
        let diseaseDetail = document.getElementById("diseaseDetail").value.trim();
        let valid = true;

        // Validation logic
        if (isNaN(age) || age < 15 || age > 60) {
            document.getElementById("errorAge").textContent = "‡∏≠‡∏≤‡∏¢‡∏∏‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 15‚Äì60 ‡∏õ‡∏µ";
            valid = false;
        }
        if (!gender) {
            document.getElementById("errorGender").textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®";
            valid = false;
        }
        if (isNaN(weight) || weight <= 0) {
            document.getElementById("errorWeight").textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ö‡∏ß‡∏Å";
            valid = false;
        }
        if (isNaN(height) || height <= 0) {
            document.getElementById("errorHeight").textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ö‡∏ß‡∏Å";
            valid = false;
        }
        if (hasDiseaseCheckbox.checked && diseaseDetail === "") {
            document.getElementById("errorDiseaseDetail").textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß";
            valid = false;
        }

        if (valid) {
            // Calculate BMI
            const bmi = weight / ((height / 100) ** 2);
            let category = "";
            let categoryColor = "";

            if (bmi < 18.5) {
                category = "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ / ‡∏ú‡∏≠‡∏° üò•";
                categoryColor = "text-yellow-600";
            } else if (bmi >= 18.5 && bmi < 25) {
                category = "‡∏™‡∏°‡∏™‡πà‡∏ß‡∏ô / ‡∏õ‡∏Å‡∏ï‡∏¥ üòä";
                categoryColor = "text-green-600";
            } else if (bmi >= 25 && bmi < 30) {
                category = "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô / ‡∏ó‡πâ‡∏ß‡∏° üòü";
                categoryColor = "text-orange-600";
            } else {
                category = "‡∏≠‡πâ‡∏ß‡∏ô üò©";
                categoryColor = "text-red-600";
            }

            modalMessage.innerHTML = `<span class="block text-2xl font-bold mb-2">BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${bmi.toFixed(2)}</span><span class="${categoryColor} font-semibold">${category}</span>`;
            resultModal.classList.remove("hidden");
        } else {
            // If validation fails, re-enable the button immediately
            submitButton.disabled = false;
            submitButton.textContent = "‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°";
        }
    });

    closeModalButton.addEventListener("click", () => {
        resultModal.classList.add("hidden");
        // Re-enable button after modal is closed
        submitButton.disabled = false;
        submitButton.textContent = "‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°";
    });
</script>

</body>
</html>